(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"0ox8":function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return c})),n.d(t,"default",(function(){return i}));var a=n("k0FJ"),o=n("oedh"),s=n("/FXl"),r=n("TjRS"),c=(n("aD51"),{});void 0!==c&&c&&c===Object(c)&&Object.isExtensible(c)&&!c.hasOwnProperty("__filemeta")&&Object.defineProperty(c,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"src/views/installation.mdx"}});var b={_frontmatter:c},p=r.a;function i(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(s.b)(p,Object(a.a)({},b,n,{components:t,mdxType:"MDXLayout"}),Object(s.b)("h1",{id:"installation"},"Installation"),Object(s.b)("p",null,"To make this library work you need to apply the ",Object(s.b)("inlineCode",{parentName:"p"},"ts-auto-mock")," transformer at compile time."),Object(s.b)("p",null,"Unfortunately, TypeScript itself does not currently provide any easy way to use custom transformers out of the box."),Object(s.b)("p",null,Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/Microsoft/TypeScript/issues/14419"}),"See this TypeScript issue"),"."),Object(s.b)("p",null,"There are different ways to do this depending on how you are currently compiling your TypeScript files"),Object(s.b)("h2",{id:"jest--ts-jest--ttypescript"},Object(s.b)("inlineCode",{parentName:"h2"},"jest")," + ",Object(s.b)("inlineCode",{parentName:"h2"},"ts-jest")," + ",Object(s.b)("inlineCode",{parentName:"h2"},"ttypescript")),Object(s.b)("h3",{id:"steps"},"Steps"),Object(s.b)("ol",null,Object(s.b)("li",{parentName:"ol"},"Install the dependencies")),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{}),"npm install jest ts-jest typescript ttypescript jest-ts-auto-mock ts-auto-mock\n")),Object(s.b)("p",null,"you need to have ",Object(s.b)("inlineCode",{parentName:"p"},"ttypescript")," installed to patch and enable the TypeScript-runtime to apply the transformer."),Object(s.b)("ol",{start:2},Object(s.b)("li",{parentName:"ol"},"Add the transformer to your ",Object(s.b)("inlineCode",{parentName:"li"},"tsconfig.json"))),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'  ...\n  "compilerOptions": {\n    ...\n    "plugins": [\n      {\n        "transform": "ts-auto-mock/transformer",\n        "cacheBetweenTests": false\n      }\n    ]\n    ...\n  }\n  ...\n')),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("p",{parentName:"li"},"Remember to set ",Object(s.b)("inlineCode",{parentName:"p"},"cacheBetweenTests")," to ",Object(s.b)("inlineCode",{parentName:"p"},"false")," because Jest runs tests in parallel and ts-auto-mock doesn't yet support caching across parallel tests")),Object(s.b)("li",{parentName:"ul"},Object(s.b)("p",{parentName:"li"},"You can find a JSON example ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/Typescript-TDD/jest-ts-auto-mock/blob/master/examples/ts-jest-ttypescript/tsconfig.json"}),"here")))),Object(s.b)("ol",{start:3},Object(s.b)("li",{parentName:"ol"},"Add ",Object(s.b)("inlineCode",{parentName:"li"},"ts-jest")," to the transformation pattern in the Jest config")),Object(s.b)("h4",{id:"packagejson--jestconfigjs-without-the-jest-scope"},Object(s.b)("strong",{parentName:"h4"},Object(s.b)("inlineCode",{parentName:"strong"},"package.json")," / ",Object(s.b)("inlineCode",{parentName:"strong"},"jest.config.js")," (without the ",Object(s.b)("inlineCode",{parentName:"strong"},"jest")," scope)")),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'...\n  "jest": {\n    "transform": {\n      ".(ts|tsx)": "ts-jest"\n    }\n  }\n...\n')),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"You can find a JSON example ",Object(s.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/Typescript-TDD/jest-ts-auto-mock/blob/master/examples/ts-jest-ttypescript/package.json"}),"here"))),Object(s.b)("ol",{start:4},Object(s.b)("li",{parentName:"ol"},"Add ",Object(s.b)("inlineCode",{parentName:"li"},"ttypescript")," to be used as ",Object(s.b)("inlineCode",{parentName:"li"},"ts-jest")," compiler")),Object(s.b)("h4",{id:"packagejson--jestconfigjs-without-the-jest-scope-1"},Object(s.b)("strong",{parentName:"h4"},Object(s.b)("inlineCode",{parentName:"strong"},"package.json")," / ",Object(s.b)("inlineCode",{parentName:"strong"},"jest.config.js")," (without the ",Object(s.b)("inlineCode",{parentName:"strong"},"jest")," scope)")),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'...\n  "jest": {\n    "globals": {\n      "ts-jest": {\n        "compiler": "ttypescript"\n      }\n    }\n  }\n...\n')),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"You can find a JSON example ",Object(s.b)("a",Object(a.a)({parentName:"li"},{href:"https://github.com/Typescript-TDD/jest-ts-auto-mock/blob/master/examples/ts-jest-ttypescript/package.json"}),"here"))),Object(s.b)("ol",{start:5},Object(s.b)("li",{parentName:"ol"},"Add ",Object(s.b)("inlineCode",{parentName:"li"},"jest-ts-auto-mock")," config file as your setup file")),Object(s.b)("h4",{id:"packagejson--jestconfigjs-without-the-jest-scope-2"},Object(s.b)("strong",{parentName:"h4"},Object(s.b)("inlineCode",{parentName:"strong"},"package.json")," / ",Object(s.b)("inlineCode",{parentName:"strong"},"jest.config.js")," (without the ",Object(s.b)("inlineCode",{parentName:"strong"},"jest")," scope)")),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'...\n  "jest": {\n    "setupFiles": [\n      "<rootDir>config.ts"\n    ]\n  }\n...\n')),Object(s.b)("h4",{id:"configts"},Object(s.b)("strong",{parentName:"h4"},Object(s.b)("inlineCode",{parentName:"strong"},"config.ts"))),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),"import 'jest-ts-auto-mock';\n")),Object(s.b)("p",null,Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/Typescript-TDD/jest-ts-auto-mock/blob/master/examples/ts-jest-ttypescript/config.ts"}),"Example")),Object(s.b)("ol",{start:6},Object(s.b)("li",{parentName:"ol"},"Create your first test")),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-ts"}),"import { createMock } from 'ts-auto-mock';\n\ninterface Interface {\n  a: string;\n  b: number;\n}\n\ndescribe('reuse', () => {\n  let mock: Interface;\n\n  beforeEach(() => {\n    mock = createMock<Interface>();\n  });\n\n  it('should work', () => {\n    expect(mock.a).toBe('');\n  });\n});\n\n")),Object(s.b)("ol",{start:7},Object(s.b)("li",{parentName:"ol"},"Run your test")),Object(s.b)("h4",{id:"packagejson"},Object(s.b)("strong",{parentName:"h4"},Object(s.b)("inlineCode",{parentName:"strong"},"package.json"))),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'...\n  "scripts": {\n    ...\n    "test": "jest"\n    ...\n  }\n...\n')),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{}),"npm run test\n")),Object(s.b)("p",null,"... and you are all done!"),Object(s.b)("h3",{id:"config-options"},"Config options"),Object(s.b)("p",null,"In the tsconfig.json you can add the config options next to the transformer name:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'"plugins": [\n  {\n    "transform": "ts-auto-mock/transformer",\n    "cacheBetweenTests": false,\n    "features": ["random"]\n  }\n]\n')),Object(s.b)("h2",{id:"webpack"},"Webpack"),Object(s.b)("p",null,"With Webpack, You can use any TypeScript-related loader that supports custom transformers, e.g. ",Object(s.b)("inlineCode",{parentName:"p"},"awesome-typescript-loader")," or ",Object(s.b)("inlineCode",{parentName:"p"},"ts-loader"),":"),Object(s.b)("h3",{id:"steps-1"},"Steps"),Object(s.b)("h4",{id:"webpackconfigjs"},Object(s.b)("strong",{parentName:"h4"},Object(s.b)("inlineCode",{parentName:"strong"},"webpack.config.js"))),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const tsAutoMockTransformer = require('ts-auto-mock/transformer').default;\n\nmodule.exports = {\n  // ...\n  module: {\n    rules: [\n      {\n        test: /\\.ts$/,\n        loader: 'ts-loader', // or 'awesome-typescript-loader'\n        options: {\n          getCustomTransformers: program => ({\n              before: [\n                  tsAutoMockTransformer(program)\n              ]\n          })\n        }\n      }\n    ]\n  }\n};\n")),Object(s.b)("h3",{id:"config-options-1"},"Config options"),Object(s.b)("p",null,"In webpack.config.js you can pass a second parameter to the transformer:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"before: [\n  tsAutoMockTransformer(program, {\n    features: ['random']\n  })\n]\n")),Object(s.b)("h2",{id:"ttypescript"},"ttypescript"),Object(s.b)("p",null,"See ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/cevek/ttypescript/blob/master/README.md"}),"ttypescript's README")," for more information"),Object(s.b)("h3",{id:"steps-2"},"Steps"),Object(s.b)("h4",{id:"tsconfigjson"},Object(s.b)("strong",{parentName:"h4"},Object(s.b)("inlineCode",{parentName:"strong"},"tsconfig.json"))),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "compilerOptions": {\n    //...,\n    "plugins": [\n      { "transform": "ts-auto-mock/transformer" }\n    ]\n  },\n  //...\n}\n')),Object(s.b)("h3",{id:"config-options-2"},"Config options"),Object(s.b)("p",null,"In the tsconfig.json you can add the config options next to the transformer name:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'"plugins": [\n  {\n    "transform": "ts-auto-mock/transformer",\n    "cacheBetweenTests": false,\n    "features": ["random"]\n  }\n]\n')),Object(s.b)("h2",{id:"ts-patch"},"ts-patch"),Object(s.b)("p",null,"See ",Object(s.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/nonara/ts-patch/blob/master/README.md"}),"ts-patch's README")),Object(s.b)("h3",{id:"steps-3"},"Steps"),Object(s.b)("p",null,"Command to run to install it:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{}),"npm i ts-patch\nts-patch install\n")),Object(s.b)("p",null,"tsconfig.json"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "compilerOptions": {\n    //...,\n    "plugins": [\n      { "transform": "ts-auto-mock/transformer" }\n    ]\n  },\n  //...\n}\n')),Object(s.b)("h3",{id:"config-options-3"},"Config options"),Object(s.b)("p",null,"In the tsconfig.json you can add the config options next to the transformer name:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'"plugins": [\n  {\n    "transform": "ts-auto-mock/transformer",\n    "cacheBetweenTests": false,\n    "features": ["random"]\n  }\n]\n')),Object(s.b)("h2",{id:"ts-node--mocha"},"ts-node + Mocha"),Object(s.b)("h3",{id:"steps-4"},"Steps"),Object(s.b)("h4",{id:"tsnodejs"},Object(s.b)("strong",{parentName:"h4"},Object(s.b)("inlineCode",{parentName:"strong"},"tsnode.js"))),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"const tsAutoMockTransformer = require('ts-auto-mock/transformer').default;\n\nrequire('ts-node').register({\n  transformers: program => ({\n    before: [\n      tsAutoMockTransformer(program)\n    ]\n  })\n});\n")),Object(s.b)("p",null,"Then inject the registration with the ",Object(s.b)("inlineCode",{parentName:"p"},"--require")," flag that Mocha passes on to Node.js:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{}),"mocha --require './tsnode.js' --watch-extensions ts,tsx \"test/**/*.{ts,tsx}\"\n")),Object(s.b)("h3",{id:"config-options-4"},"Config options"),Object(s.b)("p",null,"In tsnode.js you can pass a second parameter to the transformer:"),Object(s.b)("pre",null,Object(s.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"before: [\n  tsAutoMockTransformer(program, {\n    features: ['random']\n  })\n]\n")))}void 0!==i&&i&&i===Object(i)&&Object.isExtensible(i)&&!i.hasOwnProperty("__filemeta")&&Object.defineProperty(i,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"src/views/installation.mdx"}}),i.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-views-installation-mdx-00fdd10613c925279b07.js.map